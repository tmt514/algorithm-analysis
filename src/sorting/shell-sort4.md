# 謝耳排序法（四）

### 定理 40 [Incerpi-Sedgewick 1985]

對於一個指定步長序列的長度 $m$，存在一個序列使得謝耳排序法能在 $N^{1+O(1/\sqrt{m})}$ 的時間內完成 $N$ 個元素的排序。

### 證明


利用 Pratt 的謝耳排序法的相同套路，我們可以挑選最大的正整數 $a$ 使得 $\log_a N\log_{a+1} N \le m$。並且將所有形如 $a^i(a+1)^j$ 的整數作為步長序列的一員。
利用係理 35，每一次的 `h_sort` 需要花費的時間是 $O(Na)$。其中 $a$ 與 $m$ 的關係可以寫成 $a = N^{O(1/\sqrt{m})}$。
因此整體的時間複雜度是 $O(Nam) = N^{1+O(1/\sqrt{m})}$。

-----

如果我們希望類謝耳排序法可以做到 $O(N\log N)$ 的時間，那麼顯然步長序列的長度不能超過 $O(\log N)$。可惜的是，在限制步長序列只能是 $m$ 的情形下，Poonen 給出了謝耳排序法下界至少是 $N^{1+\Omega(1/\sqrt{m})}$ 的證明。換句話說，Incerpi-Sedgewick 的定理 40 在固定步長序列的概念下是最佳的。